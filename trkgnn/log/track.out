/lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/Train_root_zejia/Merged_Tracker_GNN.root has been converted.
Overriding batch_size to 64
2025-07-20 23:27:36,141 - [Main Process: INFO] ==> Running basic DDP on rank 0 with total size 1.
2025-07-20 23:27:36,141 - [GPU Setup: INFO] CUDA is available.
2025-07-20 23:27:36,210 - [GPU Setup: INFO] Number of available GPUs: 1
2025-07-20 23:27:36,212 - [GPU Setup: INFO] GPU 0: Tesla V100-PCIE-32GB
2025-07-20 23:27:36,285 - [torch.distributed.distributed_c10d: INFO] Added key: store_based_barrier_key:1 to store for rank: 0
2025-07-20 23:27:36,286 - [torch.distributed.distributed_c10d: INFO] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
Wandb is disabled, not logging.
2025-07-20 23:27:36,287 - [Main Process: INFO] ==> No existing model output directory found, start from scratch.
======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TrkTrans                                      --
├─New_LinkNet: 1-1                            --
│    └─Sequential: 2-1                        --
│    │    └─Linear: 3-1                       448
│    │    └─ReLU: 3-2                         --
│    │    └─Dropout: 3-3                      --
│    └─Sequential: 2-2                        --
│    │    └─Linear: 3-4                       448
│    │    └─ReLU: 3-5                         --
│    │    └─Dropout: 3-6                      --
│    └─Embedding: 2-3                         384
│    └─CBAM: 2-4                              --
│    │    └─Sequential: 3-7                   836
│    │    └─Sequential: 3-8                   15
│    └─CBAM: 2-5                              --
│    │    └─Sequential: 3-9                   836
│    │    └─Sequential: 3-10                  15
│    └─ModuleList: 2-6                        --
│    │    └─TransformerConv: 3-11             264,192
│    │    └─TransformerConv: 3-12             264,192
│    │    └─TransformerConv: 3-13             264,192
│    │    └─TransformerConv: 3-14             264,192
│    │    └─TransformerConv: 3-15             264,192
│    └─ModuleList: 2-7                        --
│    │    └─LayerNorm: 3-16                   1,024
│    │    └─LayerNorm: 3-17                   1,024
│    │    └─LayerNorm: 3-18                   1,024
│    │    └─LayerNorm: 3-19                   1,024
│    │    └─LayerNorm: 3-20                   1,024
│    └─ModuleList: 2-8                        --
│    │    └─LayerNorm: 3-21                   256
│    │    └─LayerNorm: 3-22                   256
│    │    └─LayerNorm: 3-23                   256
│    │    └─LayerNorm: 3-24                   256
│    │    └─LayerNorm: 3-25                   256
│    └─ModuleList: 2-9                        --
│    │    └─Linear: 3-26                      32,832
│    │    └─Linear: 3-27                      32,832
│    │    └─Linear: 3-28                      32,832
│    │    └─Linear: 3-29                      32,832
│    │    └─Linear: 3-30                      32,832
│    └─ModuleList: 2-10                       --
│    │    └─Linear: 3-31                      32,832
│    │    └─Linear: 3-32                      32,832
│    │    └─Linear: 3-33                      32,832
│    │    └─Linear: 3-34                      32,832
│    │    └─Linear: 3-35                      32,832
│    └─ModuleList: 2-11                       --
│    │    └─GatedFusion: 3-36                 8,256
│    │    └─GatedFusion: 3-37                 8,256
│    │    └─GatedFusion: 3-38                 8,256
│    │    └─GatedFusion: 3-39                 8,256
│    │    └─GatedFusion: 3-40                 8,256
│    └─Sequential: 2-12                       --
│    │    └─Linear: 3-41                      8,256
│    │    └─ReLU: 3-42                        --
│    │    └─Linear: 3-43                      65
======================================================================
Total params: 1,708,263
Trainable params: 1,708,263
Non-trainable params: 0
======================================================================
2025-07-20 23:27:53,142 - [Trainer: INFO] Epoch 0 Started
2025-07-20 23:27:53,142 - [utility.DataLoader: INFO] Reading from graph files
2025-07-20 23:27:53,146 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 01:58:10,873 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 02:00:24,764 - [Trainer: INFO] Epoch 0 finished
2025-07-21 02:00:24,773 - [Trainer: INFO] Epoch 0 trained 681284 samples and validated 227401 samples
2025-07-21 02:00:24,773 - [Trainer: INFO] Epoch 1 Started
2025-07-21 02:00:24,774 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 02:00:24,777 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 04:37:35,047 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 04:39:37,559 - [Trainer: INFO] Epoch 1 finished
2025-07-21 04:39:37,567 - [Trainer: INFO] Epoch 1 trained 681284 samples and validated 227401 samples
2025-07-21 04:39:37,567 - [Trainer: INFO] Epoch 2 Started
2025-07-21 04:39:37,568 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 04:39:37,572 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 07:21:18,782 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 07:23:21,621 - [Trainer: INFO] Epoch 2 finished
2025-07-21 07:23:21,629 - [Trainer: INFO] Epoch 2 trained 681284 samples and validated 227401 samples
2025-07-21 07:23:21,629 - [Trainer: INFO] Epoch 3 Started
2025-07-21 07:23:21,629 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 07:23:21,635 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 10:06:51,452 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 10:08:59,166 - [Trainer: INFO] Epoch 3 finished
2025-07-21 10:08:59,174 - [Trainer: INFO] Epoch 3 trained 681284 samples and validated 227401 samples
2025-07-21 10:08:59,174 - [Trainer: INFO] Epoch 4 Started
2025-07-21 10:08:59,175 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 10:08:59,178 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 13:00:48,771 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 13:03:24,128 - [Trainer: INFO] Epoch 4 finished
2025-07-21 13:03:24,136 - [Trainer: INFO] Epoch 4 trained 681284 samples and validated 227401 samples
2025-07-21 13:03:24,136 - [Trainer: INFO] Epoch 5 Started
2025-07-21 13:03:24,137 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 13:03:24,140 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 15:58:59,022 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 16:03:14,746 - [Trainer: INFO] Epoch 5 finished
2025-07-21 16:03:14,755 - [Trainer: INFO] Epoch 5 trained 681284 samples and validated 227401 samples
2025-07-21 16:03:14,755 - [Trainer: INFO] Epoch 6 Started
2025-07-21 16:03:14,755 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 16:03:14,761 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 18:58:25,516 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 19:00:25,344 - [Trainer: INFO] Epoch 6 finished
2025-07-21 19:00:25,356 - [Trainer: INFO] Epoch 6 trained 681284 samples and validated 227401 samples
2025-07-21 19:00:25,356 - [Trainer: INFO] Epoch 7 Started
2025-07-21 19:00:25,357 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 19:00:25,389 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-21 22:01:26,755 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-21 22:03:34,680 - [Trainer: INFO] Epoch 7 finished
2025-07-21 22:03:34,688 - [Trainer: INFO] Epoch 7 trained 681284 samples and validated 227401 samples
2025-07-21 22:03:34,688 - [Trainer: INFO] Epoch 8 Started
2025-07-21 22:03:34,689 - [utility.DataLoader: INFO] Reading from graph files
2025-07-21 22:03:34,694 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 01:05:00,342 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 01:07:05,136 - [Trainer: INFO] Epoch 8 finished
2025-07-22 01:07:05,148 - [Trainer: INFO] Epoch 8 trained 681284 samples and validated 227401 samples
2025-07-22 01:07:05,148 - [Trainer: INFO] Epoch 9 Started
2025-07-22 01:07:05,151 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 01:07:05,156 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 04:18:43,962 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 04:22:09,012 - [Trainer: INFO] Epoch 9 finished
2025-07-22 04:22:09,026 - [Trainer: INFO] Epoch 9 trained 681284 samples and validated 227401 samples
2025-07-22 04:22:09,026 - [Trainer: INFO] Epoch 10 Started
2025-07-22 04:22:09,030 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 04:22:09,102 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 07:32:35,751 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 07:34:35,515 - [Trainer: INFO] Epoch 10 finished
2025-07-22 07:34:35,523 - [Trainer: INFO] Epoch 10 trained 681284 samples and validated 227401 samples
2025-07-22 07:34:35,523 - [Trainer: INFO] Epoch 11 Started
2025-07-22 07:34:35,524 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 07:34:35,529 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 10:42:25,663 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 10:44:25,713 - [Trainer: INFO] Epoch 11 finished
2025-07-22 10:44:25,720 - [Trainer: INFO] Epoch 11 trained 681284 samples and validated 227401 samples
2025-07-22 10:44:25,720 - [Trainer: INFO] Epoch 12 Started
2025-07-22 10:44:25,721 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 10:44:25,726 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 13:54:11,092 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 13:56:11,290 - [Trainer: INFO] Epoch 12 finished
2025-07-22 13:56:11,299 - [Trainer: INFO] Epoch 12 trained 681284 samples and validated 227401 samples
2025-07-22 13:56:11,299 - [Trainer: INFO] Epoch 13 Started
2025-07-22 13:56:11,299 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 13:56:11,304 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 17:08:18,769 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 17:10:18,188 - [Trainer: INFO] Epoch 13 finished
2025-07-22 17:10:18,195 - [Trainer: INFO] Epoch 13 trained 681284 samples and validated 227401 samples
2025-07-22 17:10:18,196 - [Trainer: INFO] Epoch 14 Started
2025-07-22 17:10:18,196 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 17:10:18,202 - [utility.DataLoader: INFO] Found 636 graph files
2025-07-22 20:28:54,958 - [utility.DataLoader: INFO] All chunks are loaded
2025-07-22 20:30:55,659 - [Trainer: INFO] Epoch 14 finished
2025-07-22 20:30:55,672 - [Trainer: INFO] Epoch 14 trained 681284 samples and validated 227401 samples
2025-07-22 20:30:56,413 - [Main Process: INFO] ==> Finish running basic DDP on rank 0.
load_model_summary took a total of 0.0007 seconds. [counts:    1]
get_data_loaders took a total of 0.0001 seconds. [counts:   15]
load_graph took a total of 0.0000 seconds. [counts:   15]
GNNTrackData.__init__ took a total of 0.3298 seconds. [counts: 19080]
CBAM.forward took a total of 1386.3891 seconds. [counts: 450810]
GatedFusion.forward took a total of 1914.8345 seconds. [counts: 2254050]
New_LinkNet.forward took a total of 12389.0261 seconds. [counts: 225405]
TrkTrans.forward took a total of 12395.1230 seconds. [counts: 225405]
Trainer.train_iteration took a total of 86047.3509 seconds. [counts: 9540]
Trainer.eval_link took a total of 56328.9375 seconds. [counts: 58800]
Trainer.valid_iteration took a total of 59270.6784 seconds. [counts: 9540]
Trainer.process_epoch took a total of 162182.5256 seconds. [counts:   15]
Trainer.process took a total of 162183.2699 seconds. [counts:    1]
(0, 0.004)
(2544, 0.0004)
(5088, 4e-05)
(6360, 4e-06)
(7632, 4.0000000000000003e-07)
Overriding batch_size to 64
2025-07-22 20:34:00,386 - [Main Process: INFO] ==> Running basic DDP on rank 0 with total size 1.
2025-07-22 20:34:00,387 - [GPU Setup: INFO] CUDA is available.
2025-07-22 20:34:00,454 - [GPU Setup: INFO] Number of available GPUs: 1
2025-07-22 20:34:00,460 - [GPU Setup: INFO] GPU 0: Tesla V100-PCIE-32GB
2025-07-22 20:34:00,468 - [torch.distributed.distributed_c10d: INFO] Added key: store_based_barrier_key:1 to store for rank: 0
2025-07-22 20:34:00,469 - [torch.distributed.distributed_c10d: INFO] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
Wandb is disabled, not logging.
2025-07-22 20:34:00,469 - [Main Process: INFO] ==> No existing model output directory found, start from scratch.
======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TrkTrans                                      --
├─New_LinkNet: 1-1                            --
│    └─Sequential: 2-1                        --
│    │    └─Linear: 3-1                       448
│    │    └─ReLU: 3-2                         --
│    │    └─Dropout: 3-3                      --
│    └─Sequential: 2-2                        --
│    │    └─Linear: 3-4                       448
│    │    └─ReLU: 3-5                         --
│    │    └─Dropout: 3-6                      --
│    └─Embedding: 2-3                         384
│    └─CBAM: 2-4                              --
│    │    └─Sequential: 3-7                   836
│    │    └─Sequential: 3-8                   15
│    └─CBAM: 2-5                              --
│    │    └─Sequential: 3-9                   836
│    │    └─Sequential: 3-10                  15
│    └─ModuleList: 2-6                        --
│    │    └─TransformerConv: 3-11             264,192
│    │    └─TransformerConv: 3-12             264,192
│    │    └─TransformerConv: 3-13             264,192
│    │    └─TransformerConv: 3-14             264,192
│    │    └─TransformerConv: 3-15             264,192
│    └─ModuleList: 2-7                        --
│    │    └─LayerNorm: 3-16                   1,024
│    │    └─LayerNorm: 3-17                   1,024
│    │    └─LayerNorm: 3-18                   1,024
│    │    └─LayerNorm: 3-19                   1,024
│    │    └─LayerNorm: 3-20                   1,024
│    └─ModuleList: 2-8                        --
│    │    └─LayerNorm: 3-21                   256
│    │    └─LayerNorm: 3-22                   256
│    │    └─LayerNorm: 3-23                   256
│    │    └─LayerNorm: 3-24                   256
│    │    └─LayerNorm: 3-25                   256
│    └─ModuleList: 2-9                        --
│    │    └─Linear: 3-26                      32,832
│    │    └─Linear: 3-27                      32,832
│    │    └─Linear: 3-28                      32,832
│    │    └─Linear: 3-29                      32,832
│    │    └─Linear: 3-30                      32,832
│    └─ModuleList: 2-10                       --
│    │    └─Linear: 3-31                      32,832
│    │    └─Linear: 3-32                      32,832
│    │    └─Linear: 3-33                      32,832
│    │    └─Linear: 3-34                      32,832
│    │    └─Linear: 3-35                      32,832
│    └─ModuleList: 2-11                       --
│    │    └─GatedFusion: 3-36                 8,256
│    │    └─GatedFusion: 3-37                 8,256
│    │    └─GatedFusion: 3-38                 8,256
│    │    └─GatedFusion: 3-39                 8,256
│    │    └─GatedFusion: 3-40                 8,256
│    └─Sequential: 2-12                       --
│    │    └─Linear: 3-41                      8,256
│    │    └─ReLU: 3-42                        --
│    │    └─Linear: 3-43                      65
======================================================================
Total params: 1,708,263
Trainable params: 1,708,263
Non-trainable params: 0
======================================================================
2025-07-22 20:34:19,151 - [Trainer: INFO] Epoch 0 Started
2025-07-22 20:34:19,152 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 20:34:19,152 - [utility.DataLoader: WARNING] The directory /lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/output_single_200/DigitizedRecTrk does not exist.
Overriding batch_size to 64
CUDA is available.
Number of available GPUs: 1, but only 1 is used.
2025-07-22 20:34:26,955 - [Apply.Link: INFO] input_dir: ['/lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/output_single_200']
2025-07-22 20:34:26,956 - [Apply.Link: INFO] model_dir: /lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/output_200.link.rec/model.checkpoints/model_checkpoint_014.pth.tar
2025-07-22 20:34:26,956 - [Apply.Link: INFO] output_dir: apply_200.link.rec.0p999
======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TrkTrans                                      --
├─New_LinkNet: 1-1                            --
│    └─Sequential: 2-1                        --
│    │    └─Linear: 3-1                       448
│    │    └─ReLU: 3-2                         --
│    │    └─Dropout: 3-3                      --
│    └─Sequential: 2-2                        --
│    │    └─Linear: 3-4                       448
│    │    └─ReLU: 3-5                         --
│    │    └─Dropout: 3-6                      --
│    └─Embedding: 2-3                         384
│    └─CBAM: 2-4                              --
│    │    └─Sequential: 3-7                   836
│    │    └─Sequential: 3-8                   15
│    └─CBAM: 2-5                              --
│    │    └─Sequential: 3-9                   836
│    │    └─Sequential: 3-10                  15
│    └─ModuleList: 2-6                        --
│    │    └─TransformerConv: 3-11             264,192
│    │    └─TransformerConv: 3-12             264,192
│    │    └─TransformerConv: 3-13             264,192
│    │    └─TransformerConv: 3-14             264,192
│    │    └─TransformerConv: 3-15             264,192
│    └─ModuleList: 2-7                        --
│    │    └─LayerNorm: 3-16                   1,024
│    │    └─LayerNorm: 3-17                   1,024
│    │    └─LayerNorm: 3-18                   1,024
│    │    └─LayerNorm: 3-19                   1,024
│    │    └─LayerNorm: 3-20                   1,024
│    └─ModuleList: 2-8                        --
│    │    └─LayerNorm: 3-21                   256
│    │    └─LayerNorm: 3-22                   256
│    │    └─LayerNorm: 3-23                   256
│    │    └─LayerNorm: 3-24                   256
│    │    └─LayerNorm: 3-25                   256
│    └─ModuleList: 2-9                        --
│    │    └─Linear: 3-26                      32,832
│    │    └─Linear: 3-27                      32,832
│    │    └─Linear: 3-28                      32,832
│    │    └─Linear: 3-29                      32,832
│    │    └─Linear: 3-30                      32,832
│    └─ModuleList: 2-10                       --
│    │    └─Linear: 3-31                      32,832
│    │    └─Linear: 3-32                      32,832
│    │    └─Linear: 3-33                      32,832
│    │    └─Linear: 3-34                      32,832
│    │    └─Linear: 3-35                      32,832
│    └─ModuleList: 2-11                       --
│    │    └─GatedFusion: 3-36                 8,256
│    │    └─GatedFusion: 3-37                 8,256
│    │    └─GatedFusion: 3-38                 8,256
│    │    └─GatedFusion: 3-39                 8,256
│    │    └─GatedFusion: 3-40                 8,256
│    └─Sequential: 2-12                       --
│    │    └─Linear: 3-41                      8,256
│    │    └─ReLU: 3-42                        --
│    │    └─Linear: 3-43                      65
======================================================================
Total params: 1,708,263
Trainable params: 1,708,263
Non-trainable params: 0
======================================================================
2025-07-22 20:34:28,868 - [utility.EverythingNeeded: DEBUG] Parameters: 1708263
Overriding batch_size to 64
2025-07-22 20:34:41,352 - [Main Process: INFO] ==> Running basic DDP on rank 0 with total size 1.
2025-07-22 20:34:41,353 - [GPU Setup: INFO] CUDA is available.
2025-07-22 20:34:41,422 - [GPU Setup: INFO] Number of available GPUs: 1
2025-07-22 20:34:41,424 - [GPU Setup: INFO] GPU 0: Tesla V100-PCIE-32GB
2025-07-22 20:34:41,427 - [torch.distributed.distributed_c10d: INFO] Added key: store_based_barrier_key:1 to store for rank: 0
2025-07-22 20:34:41,428 - [torch.distributed.distributed_c10d: INFO] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
Wandb is disabled, not logging.
2025-07-22 20:34:41,429 - [Main Process: INFO] ==> No existing model output directory found, start from scratch.
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
MomNet                                   --
├─Sequential: 1-1                        --
│    └─Linear: 2-1                       448
│    └─ReLU: 2-2                         --
│    └─Linear: 2-3                       4,160
│    └─ReLU: 2-4                         --
├─Sequential: 1-2                        --
│    └─Linear: 2-5                       320
│    └─ReLU: 2-6                         --
│    └─Linear: 2-7                       4,160
│    └─ReLU: 2-8                         --
├─ModuleList: 1-3                        --
│    └─TransformerConv: 2-9              --
│    │    └─SumAggregation: 3-1          --
│    │    └─Linear: 3-2                  4,160
│    │    └─Linear: 3-3                  4,160
│    │    └─Linear: 3-4                  4,160
│    │    └─Linear: 3-5                  4,096
│    │    └─Linear: 3-6                  4,160
│    └─TransformerConv: 2-10             --
│    │    └─SumAggregation: 3-7          --
│    │    └─Linear: 3-8                  4,160
│    │    └─Linear: 3-9                  4,160
│    │    └─Linear: 3-10                 4,160
│    │    └─Linear: 3-11                 4,096
│    │    └─Linear: 3-12                 4,160
│    └─TransformerConv: 2-11             --
│    │    └─SumAggregation: 3-13         --
│    │    └─Linear: 3-14                 4,160
│    │    └─Linear: 3-15                 4,160
│    │    └─Linear: 3-16                 4,160
│    │    └─Linear: 3-17                 4,096
│    │    └─Linear: 3-18                 4,160
├─ModuleList: 1-4                        --
│    └─Sequential: 2-12                  --
│    │    └─Linear: 3-19                 8,256
│    │    └─ReLU: 3-20                   --
│    │    └─Linear: 3-21                 4,160
│    │    └─ReLU: 3-22                   --
│    └─Sequential: 2-13                  --
│    │    └─Linear: 3-23                 8,256
│    │    └─ReLU: 3-24                   --
│    │    └─Linear: 3-25                 4,160
│    │    └─ReLU: 3-26                   --
│    └─Sequential: 2-14                  --
│    │    └─Linear: 3-27                 8,256
│    │    └─ReLU: 3-28                   --
│    │    └─Linear: 3-29                 4,160
│    │    └─ReLU: 3-30                   --
├─ModuleList: 1-5                        --
│    └─LayerNorm: 2-15                   128
│    └─LayerNorm: 2-16                   128
│    └─LayerNorm: 2-17                   128
├─ModuleList: 1-6                        --
│    └─LayerNorm: 2-18                   128
│    └─LayerNorm: 2-19                   128
│    └─LayerNorm: 2-20                   128
├─Sequential: 1-7                        --
│    └─Linear: 2-21                      8,256
│    └─ReLU: 2-22                        --
│    └─Linear: 2-23                      65
├─TransformerConv: 1-8                   --
│    └─SumAggregation: 2-24              --
│    └─Linear: 2-25                      4,160
│    └─Linear: 2-26                      4,160
│    └─Linear: 2-27                      4,160
│    └─Linear: 2-28                      4,096
│    └─Linear: 2-29                      4,160
├─Sequential: 1-9                        --
│    └─Linear: 2-30                      8,256
│    └─ReLU: 2-31                        --
│    └─Linear: 2-32                      65
=================================================================
Total params: 146,690
Trainable params: 146,690
Non-trainable params: 0
=================================================================
2025-07-22 20:34:43,578 - [Trainer: INFO] Epoch 0 Started
2025-07-22 20:34:43,579 - [utility.DataLoader: INFO] Reading from graph files
2025-07-22 20:34:43,579 - [utility.DataLoader: WARNING] The directory /lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/apply.link.rec/DigitizedRecTrk does not exist.
Overriding batch_size to 64
CUDA is available.
Number of available GPUs: 1, but only 1 is used.
2025-07-22 20:34:49,878 - [Apply.Momentum: INFO] input_dir: ['/lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/apply.link.rec/']
2025-07-22 20:34:49,880 - [Apply.Momentum: INFO] model_dir: /lustre/collider/wanghuayang/DeepLearning/Tracking/trkgnn/output.momentum.rec/model.checkpoints/model_checkpoint_014.pth.tar
2025-07-22 20:34:49,880 - [Apply.Momentum: INFO] output_dir: apply.momentum.rec.0p999
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
MomNet                                   --
├─Sequential: 1-1                        --
│    └─Linear: 2-1                       448
│    └─ReLU: 2-2                         --
│    └─Linear: 2-3                       4,160
│    └─ReLU: 2-4                         --
├─Sequential: 1-2                        --
│    └─Linear: 2-5                       320
│    └─ReLU: 2-6                         --
│    └─Linear: 2-7                       4,160
│    └─ReLU: 2-8                         --
├─ModuleList: 1-3                        --
│    └─TransformerConv: 2-9              --
│    │    └─SumAggregation: 3-1          --
│    │    └─Linear: 3-2                  4,160
│    │    └─Linear: 3-3                  4,160
│    │    └─Linear: 3-4                  4,160
│    │    └─Linear: 3-5                  4,096
│    │    └─Linear: 3-6                  4,160
│    └─TransformerConv: 2-10             --
│    │    └─SumAggregation: 3-7          --
│    │    └─Linear: 3-8                  4,160
│    │    └─Linear: 3-9                  4,160
│    │    └─Linear: 3-10                 4,160
│    │    └─Linear: 3-11                 4,096
│    │    └─Linear: 3-12                 4,160
│    └─TransformerConv: 2-11             --
│    │    └─SumAggregation: 3-13         --
│    │    └─Linear: 3-14                 4,160
│    │    └─Linear: 3-15                 4,160
│    │    └─Linear: 3-16                 4,160
│    │    └─Linear: 3-17                 4,096
│    │    └─Linear: 3-18                 4,160
├─ModuleList: 1-4                        --
│    └─Sequential: 2-12                  --
│    │    └─Linear: 3-19                 8,256
│    │    └─ReLU: 3-20                   --
│    │    └─Linear: 3-21                 4,160
│    │    └─ReLU: 3-22                   --
│    └─Sequential: 2-13                  --
│    │    └─Linear: 3-23                 8,256
│    │    └─ReLU: 3-24                   --
│    │    └─Linear: 3-25                 4,160
│    │    └─ReLU: 3-26                   --
│    └─Sequential: 2-14                  --
│    │    └─Linear: 3-27                 8,256
│    │    └─ReLU: 3-28                   --
│    │    └─Linear: 3-29                 4,160
│    │    └─ReLU: 3-30                   --
├─ModuleList: 1-5                        --
│    └─LayerNorm: 2-15                   128
│    └─LayerNorm: 2-16                   128
│    └─LayerNorm: 2-17                   128
├─ModuleList: 1-6                        --
│    └─LayerNorm: 2-18                   128
│    └─LayerNorm: 2-19                   128
│    └─LayerNorm: 2-20                   128
├─Sequential: 1-7                        --
│    └─Linear: 2-21                      8,256
│    └─ReLU: 2-22                        --
│    └─Linear: 2-23                      65
├─TransformerConv: 1-8                   --
│    └─SumAggregation: 2-24              --
│    └─Linear: 2-25                      4,160
│    └─Linear: 2-26                      4,160
│    └─Linear: 2-27                      4,160
│    └─Linear: 2-28                      4,096
│    └─Linear: 2-29                      4,160
├─Sequential: 1-9                        --
│    └─Linear: 2-30                      8,256
│    └─ReLU: 2-31                        --
│    └─Linear: 2-32                      65
=================================================================
Total params: 146,690
Trainable params: 146,690
Non-trainable params: 0
=================================================================
